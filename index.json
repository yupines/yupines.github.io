[{"content":"I am a M.S. student in Shanghai jiaotong University. And my major is immunology. In Mid-2020, I transferred to dedicated bioinformatic analysis. My researches focus on profiling multi-omics data to decipher heterogenous immune microenvironment. Besides, I'm intrested in machine learning in augmenting omics-data integration and their extensive applications in immune biology. Here, I wanna blog my learning experience and share with everyoneï¼ğŸ™‹ \nLatest\nuniPort: a unified computational framework for single-cell data integration with optimal transport https://www.biorxiv.org/content/10.1101/2022.02.14.480323v1.article-metrics  \n","permalink":"https://yupines.github.io/me/","summary":"I am a M.S. student in Shanghai jiaotong University. And my major is immunology. In Mid-2020, I transferred to dedicated bioinformatic analysis. My researches focus on profiling multi-omics data to decipher heterogenous immune microenvironment. Besides, I'm intrested in machine learning in augmenting omics-data integration and their extensive applications in immune biology. Here, I wanna blog my learning experience and share with everyoneï¼ğŸ™‹ \nLatest\nuniPort: a unified computational framework for single-cell data integration with optimal transport https://www.","title":"About me"},{"content":" ç»è¿‡ä¸€æ®µæ—¶é—´ä¸œæ‹¼è¥¿å‡‘çš„å­¦ä¹ ï¼Œå°ç™½ç»ˆäºèƒ½ç†è§£å˜åˆ†è‡ªç¼–ç å™¨äº†å“ˆå“ˆå“ˆï¼Œæ„Ÿè°¢å„è·¯å¤§ç¥çš„æ•™ç¨‹ï¼åœ¨è¿™é‡Œæ•´ç†ä¸€äº›ç®€çŸ­çš„ç¬”è®°ã€‚\nä¸€ã€VAEçš„åˆæ­¥ç†è§£  1. ç»™å®šçœŸå®æ ·æœ¬$X_k$,å‡è®¾å­˜åœ¨ä¸“å±äº$X_k$çš„åéªŒåˆ†å¸ƒ$p(Z|X_k)$,å¹¶å‡å®šè¿™ä¸ªåˆ†å¸ƒæ˜¯æ­£æ€å¤šå…ƒçš„ï¼Œä¸“å±çš„ç›®çš„æ˜¯è®­ç»ƒç”Ÿæˆå™¨$X = g(Z)$,ä»åˆ†å¸ƒ$p(Z|X_k)$é‡‡æ ·å‡ºä¸€ä¸ª$Z_k$å¹¶è¿˜åŸä¸º$\\hat{X_k}$ã€‚\n2. ä½¿ç”¨ç¥ç»ç½‘ç»œæ‹Ÿåˆæ­£æ€åˆ†å¸ƒçš„å‚æ•°ï¼šå‡å€¼$\\mu$å’Œæ–¹å·®${\\sigma}^2$ã€‚äºæ˜¯æ„å»ºä¸¤ä¸ªç¥ç»ç½‘ç»œï¼š${\\mu}k = {f}_1(X_k)$å’Œ${\\log}{\\sigma}_k^2 = {f}_2(X_k)$ ï¼ˆä¸éœ€è¦æ¿€æ´»å‡½æ•°çš„å¤„ç†ï¼‰ã€‚\n3. é‡æ„Xçš„è¿‡ç¨‹éœ€æœ€å°åŒ–$(\\hat{X_k},X_k)$çš„è·ç¦»ï¼Œé‡æ„å™ªå£°ï¼ˆå³æ–¹å·®ï¼‰æ—¢è¦å°½å¯èƒ½åœ°å°ï¼ˆå‡å°‘é‡æ„è¯¯å·®ï¼‰ï¼ŒåŒæ—¶åˆè¦é˜²æ­¢é€€åŒ–ä¸º0ï¼ˆä¿è¯æ¨¡å‹å…·æœ‰ç”Ÿæˆèƒ½åŠ›ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥è®©æ‰€æœ‰æ ·æœ¬çš„$p(Z|X_k)$å‘æ ‡å‡†æ­£æ€åˆ†å¸ƒçœ‹é½ã€‚è‹¥æ¥è¿‘æ­£æ€åˆ†å¸ƒ$N(0,I)$ï¼Œåˆ™ï¼š $$p(Z) = \\sum\\limits_{X}p(Z|X)p(X) = \\sum N(0,I)p(X) = N(0,I)$$ $p(Z)$æ»¡è¶³æ­£æ€åˆ†å¸ƒã€‚æ¥ä¸‹æ¥åˆ©ç”¨KLæ•£åº¦æ¥è®¡ç®—lossï¼Œå³$KL(N(\\mu,{\\sigma}^2)||N(0,I))$ï¼Œè®¡ç®—ç»“æœä¸ºï¼š\n$$\\mathcal{L}_{\\mu,{\\sigma}^2} = \\frac{1}{2}\\sum\\limits_{i=1}^d({\\mu}_{(i)}^2 + {\\sigma}^2_{(i)}-{\\log}{\\sigma}^2_{(i)}-1) $$ å…¶ä¸­$d$æ˜¯å› å˜é‡$Z$çš„ç»´åº¦ã€‚\n 4. é‡å‚æ•°æŠ€å·§ï¼šä»æ­£æ€åˆ†å¸ƒä¸­é‡‡æ · $\\varepsilon$ï¼Œç„¶å$Z = \\mu + \\varepsilon * \\sigma$  äºŒã€VAEçš„ç›®æ ‡å‡½æ•°  ï¼ˆä¸€ï¼‰èƒŒæ™¯çŸ¥è¯†  1.è¾¹ç¼˜åˆ†å¸ƒ  å‡è®¾$p(x,y)$,å…¶ä¸­ä¸€ä¸ªç‰¹å®šå˜é‡çš„è¾¹ç¼˜åˆ†å¸ƒä¸ºï¼š $$p(x) = \\sum\\limits_{y}p(x,y) = \\sum\\limits_{y}p(x|y)p(y)$$  2.äº¤å‰ç†µå’ŒKLæ•£åº¦  äº¤å‰ç†µå’ŒKLå…³ç³»å¯†åˆ‡ï¼Œå¯ä»¥ç”¨æ¥è¡¡é‡ä¸¤ä¸ªåˆ†å¸ƒçš„å·®å¼‚ï¼Œä»¥ç¦»æ•£å˜é‡$x$ä¸ºä¾‹ï¼š $$H(P,Q)=-\\mathbb{E}_{x\\sim P}\\ {\\log}Q(x) = -\\sum\\limits_{i=1}^N P(x_i){\\log}Q(x_i)$$ $KL$æ•£åº¦å®šä¹‰ï¼Œå¯¹$P,Q$åˆ†å¸ƒæœ‰ï¼š $$D_{KL}(P||Q) = \\mathbb{E}_{x\\sim P}[{\\log}\\frac{P(x)}{Q(x)}] = \\mathbb{E}_{x\\sim P}[{\\log}P(x) - {\\log}Q(x)] $$ å¯¹äºç¦»æ•£å‹å˜é‡æœ‰ï¼š $$D_{KL}(P||Q) = \\sum\\limits_{i=1}^N P(x_i)\\ {\\log}(\\frac{P(x_i)}{Q(x_i)}) = \\sum\\limits_{i=1}^N P(x_i)\\ [{\\log}P(x_i)-{\\log}Q(x_i)] $$ å¯¹äºè¿ç»­å‹å˜é‡ï¼Œå…¶æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆprobability density functionï¼ŒPDFï¼‰ç”¨å°å†™å­—æ¯$p(x)$å’Œ$q(x)$æ¥è¡¨ç¤ºï¼Œç¦»æ•£å‹éšæœºå˜é‡çš„æ¦‚ç‡è´¨é‡å‡½æ•°ï¼ˆprobability mass functionï¼ŒPMFï¼‰ç”¨å¤§å†™å­—æ¯è¡¨ç¤ºã€‚\nä»¥ç¦»æ•£å˜é‡ä¸ºä¾‹ï¼Œå¯¹äº$KL$æ•£åº¦å…¬å¼å±•å¼€å¯å¾—åˆ°ï¼š $$\\begin{aligned} D_{KL}(P||Q) \u0026= \\sum\\limits_{i=1}^N P(x_i)\\ [{\\log}P(x_i)-{\\log}Q(x_i)] \\\\ \u0026= \\sum\\limits_{i=1}^N P(x_i)\\ {\\log}P(x_i) - \\sum\\limits_{i=1}^N P(x_i)\\ {\\log}Q(x_i) \\\\ \u0026= -[-\\sum\\limits_{i=1}^N P(x_i)\\ {\\log}P(x_i)]+[-\\sum\\limits_{i=1}^N P(x_i)\\ {\\log}Q(x_i)] \\\\ \u0026=-H(P) + H(P,Q) \\end{aligned}$$ å³$H(P,Q) = H(P) + D_{KL}(P||Q)$  3.EMç®—æ³•  Expectation Maximization Algorithm,ä¸€ç§è¿­ä»£ç®—æ³•ï¼Œç”¨äºå«æœ‰éšå˜é‡çš„æ¦‚ç‡å‚æ•°æ¨¡å‹çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡æˆ–æå¤§åéªŒæ¦‚ç‡ä¼°è®¡ã€‚åˆ†ä¸ºExpection-Step å’Œ Maximization-Stepã€‚E-Step ä¸»è¦é€šè¿‡è§‚å¯Ÿæ•°æ®å’Œç°æœ‰æ¨¡å‹æ¥ä¼°è®¡å‚æ•°ï¼Œç”±æ­¤è®¡ç®—ä¼¼ç„¶å‡½æ•°çš„æœŸæœ›å€¼ï¼›M-Step å¯»æ‰¾ä¼¼ç„¶å‡½æ•°æœ€å¤§æ—¶å¯¹åº”çš„å‚æ•°ã€‚\nEMç®—æ³•çš„ä¸€èˆ¬æ€è·¯ï¼š $$\\begin{aligned} L(\\theta) \u0026= \\mathbb{E}_{x\\sim data}[{\\log}\\ p_{\\theta}(x)] \\\\ \u0026= \\mathbb{E}_{x\\sim data}[{\\log}\\ p_{\\theta}(z,x)-{\\log}\\ p_{\\theta}(z|x)]\\\\ \u0026= \\mathbb{E}_{\\phi}[{\\log}\\ p_{\\theta}(z,x)]-\\mathbb{E}_{\\phi}[{\\log}\\ p_{\\theta}(z|x)] \\\\ \u0026= \\mathbb{E}_{\\phi}[{\\log}\\ p_{\\theta}(z,x)] + H(\\phi) + KL(\\phi||\\theta) \\end{aligned}$$ å¼•å…¥ä»»æ„åˆ†å¸ƒ$z$å’Œå‚æ•°$\\theta,\\forall \\phi$ STEPSï¼šåˆå§‹åŒ–å‚æ•°$\\theta$ï¼Œé‡å¤è®¡ç®—Eå’ŒMæ­¥éª¤\nE-Stepï¼šæ ¹æ®$p_{\\theta}(z)$å’Œ$p_{\\theta}(x|z)$æ±‚å‡ºreferenceï¼Œå³$p_{\\theta}(x|z)$ï¼Œä»¤${\\phi}={\\theta}$; M-Stepï¼šå›ºå®š$\\phi$åï¼Œå¯»æ‰¾æ–°çš„å‚æ•°$\\theta$ï¼Œä½¿å¾—$\\mathbb{E}_{x\\sim data}[{\\log}_{\\theta}(x)]$å¢å¤§ï¼ˆå³â€˜è¾…åŠ©å‡½æ•°â€™ï¼‰ã€‚ åœ¨è¿­ä»£ä¸­ï¼Œ$\\mathbb{E}_{x\\sim data}[{\\log}\\ p_{\\theta}(x)]$ä¸æ–­å¢å¤§ï¼Œ$H(\\phi)$ä¸$\\theta$æ— å…³ï¼Œ$KL(\\phi||\\theta) = 0$ å˜æˆäº† $KL(\\phi||\\theta)0$ï¼Œäºæ˜¯éšç€è¿­ä»£è¿›è¡Œï¼Œç›®æ ‡å‡½æ•°$L(\\theta)$ä¸æ–­å¢å¤§ã€‚  ï¼ˆäºŒï¼‰ä»æ¦‚ç‡å›¾æ¨¡å‹çš„è§’åº¦ç†è§£   VAEçš„è®­ç»ƒè¿‘ä¼¼EM  å‡è®¾ä¸€ä¸ªæ¦‚ç‡å›¾æ¨¡å‹ï¼Œå¯ä»¥ç”Ÿæˆéšå˜é‡$z$ï¼Œç„¶åç”Ÿæˆè§‚æµ‹å˜é‡$x$ï¼Œå‚æ•°ä¸º$\\theta$ã€‚å¾—åˆ°åˆ†å¸ƒï¼š$p_{\\theta}(z)$å’Œ$p_{\\theta}(x|z)$ã€‚ç”±æ­¤æ¨æµ‹éšè—åˆ†å¸ƒï¼š$x$çš„è¾¹ç¼˜åˆ†å¸ƒ$p_{\\theta}(x)$å’Œ$z$çš„æ¡ä»¶åˆ†å¸ƒ$p_{\\theta}(z|x)$ã€‚æ¨¡å‹å¯ä»¥é‡‡ç”¨æœ€å¤§ä¼¼ç„¶æ³•è®­ç»ƒï¼Œæ‰¾åˆ°ä½¿å¾—$L(\\theta) = \\mathbb{E}_{x\\sim data}{\\log}\\ p_{\\theta}(x)$æœ€å¤§çš„å‚æ•°$\\theta$ã€‚ å¯¹äºVAEæ¥è¯´ï¼Œ$p_{\\theta}(z)$ å›ºå®šä¸º$N(0,I)$ï¼Œè€Œ$p_{\\theta}(x|z)$ ç”±decoderå®šä¹‰ï¼Œäºæ˜¯EMç®—æ³•ä¸­çš„ç›®æ ‡å‡½æ•°å˜æˆï¼š $$\\begin{aligned} L(\\theta) \u0026= \\mathbb{E}_{\\phi}[{\\log}\\ p_{\\theta}(z,x)] + H(\\phi) + KL(\\phi||\\theta) \\\\ \u0026= \\mathbb{E}_{\\phi}[{\\log}\\ p_{\\theta}(z)\\ +{\\log}\\ p_{\\theta}(x|z)] + H(\\phi) + KL(\\phi||\\theta) \\\\ \u0026= \\mathbb{E}_{\\phi}{\\log}\\ p_{\\theta}(x|z)\\ -[H(\\phi)+KL(\\phi||p_{\\theta}(z))]+ H(\\phi) + KL(\\phi||\\theta) \\\\ \u0026= \\mathbb{E}_{\\phi}{\\log}\\ p_{\\theta}(x|z)\\ -KL(\\phi||p_{\\theta}(z))+ KL(\\phi||\\theta) \\end{aligned}$$ æ­¤æ—¶ï¼Œç†æƒ³çš„EMç®—æ³•æ­¥éª¤ä¸ºï¼š\nE-Stepï¼šä»¤$\\phi$ä¸ºæ¦‚ç‡å›¾æ¨¡å‹ä¸­éšå«çš„æ¡ä»¶åˆ†å¸ƒ$p_{\\theta}(z|x)$ï¼›\nS-Stepï¼šå¯»æ‰¾æ–°çš„$\\theta$ä½¿å¾—$L(\\theta)$ç»§ç»­å¢å¤§ã€‚\nä½†å¯¹äºVAEè€Œè¨€ï¼Œ$p_{\\theta}(z|x)$æ— æ³•æ˜¾ç¤ºè¡¨è¾¾å‡ºæ¥ï¼Œäºæ˜¯VAEè®¾è®¡ä¸€ä¸ªå‚æ•°ä¸º$\\phi$çš„ç½‘ç»œæ¥è¿‘ä¼¼$\\theta$ã€‚å®é™…EMç®—æ³•å¦‚ä¸‹ï¼š\nE-Stepï¼šä»¤$\\phi$é€¼è¿‘ $\\theta$ï¼›\nM-Stepï¼šå¯»æ‰¾ $\\theta$ æ¥å¢å¤§ $\\mathbb{E}_{\\phi}{\\log}$ å¯ä»¥çœ‹å‡ºè¿­ä»£çš„è¿‡ç¨‹ä¸»è¦ä½¿ $\\mathbb{E}_{\\phi}{\\log}\\ p_{\\theta}(x|z)\\ -KL(\\phi||p_{\\theta}(z))$ å¢å¤§ï¼Œä½¿ $KL(\\phi||\\theta)$ é€¼è¿‘é›¶ã€‚\näºæ˜¯å®šä¹‰ï¼šEvidence Lower BOundï¼ˆELBOï¼‰ $$ELBO(\\theta,\\phi) = \\mathbb{E}_{x\\sim data}[\\mathbb{E}_{\\phi}{\\log}\\ p_{\\theta}(x|z)\\ -\\ KL({\\phi}||N(0,I))] $$ evidenceæŒ‡çš„æ˜¯ç›®æ ‡å‡½æ•° ${\\log}\\ p_{\\theta}(x)$ï¼Œå› ä¸º $KL(\\phi||\\theta)$ éè´Ÿï¼Œæ‰€ä»¥å‰ä¸¤é¡¹ä¸ºç›®æ ‡å‡½æ•°çš„ä¸‹ç•Œã€‚ELBOå³ä¸ºVAEçš„ç›®æ ‡å‡½æ•°ï¼Œç”±äºE-Mæ­¥å¢å¤§çš„ç›®æ ‡æ˜¯ç›¸åŒçš„ï¼Œå¯ä»¥åˆå¹¶ï¼Œç”¨æ¢¯åº¦ä¸Šå‡æ³•æ¥æœ€å¤§åŒ–ELBOï¼Œæœ€å¤§åŒ–ç›®æ ‡å‡½æ•°çš„ä¸‹ç•Œï¼Œä»¥æ­¤é—´æ¥æœ€å¤§åŒ–ç›®æ ‡å‡½æ•°ã€‚ ï¼ˆä¸‰ï¼‰ä»ç¥ç»ç½‘ç»œçš„è§’åº¦ç†è§£  VAEæ˜¯å¸¦æœ‰æ­£åˆ™åŒ–çš„è‡ªç¼–ç å™¨  æ™®é€šè‡ªç¼–ç å™¨ç”±ç¼–ç å™¨ $z = g_{\\phi}(x)$ å’Œè§£ç å™¨ $x = f_{\\theta}(z)$ æ„æˆã€‚ç›®æ ‡å‡½æ•°æ˜¯æœ€å°åŒ– $D(x,f_{\\theta}(g_{\\phi}(x)))$ã€‚è‹¥$x$æ˜¯äºŒå€¼ï¼Œåˆ™ $f_{\\theta}(z)$ ä»£è¡¨ä¼¯åŠªåˆ©åˆ†å¸ƒå‡å€¼ï¼›è‹¥$x$æ˜¯ä»»æ„å®æ•°ï¼Œåˆ™ $f_{\\theta}(z)$ ä»£è¡¨æ­£æ€åˆ†å¸ƒï¼Œé‡æ„è¯¯å·®å¯ä»¥å†™æˆ $-{\\log}\\ p_{\\theta}(x|z)$ï¼Œæœ€å¤§ä¼¼ç„¶è®­ç»ƒç­‰ä»·äºæœ€å°åŒ–é‡æ„è¯¯å·®: $$L_{reconstruct}(\\theta,\\phi) = -\\ \\mathbb{E}_{x\\sim data}\\mathbb{E}_{\\phi}{\\log}\\ p_{\\theta}(x|z) $$ VAEé™¤äº†é‡æ„ï¼Œè¿˜è¦è€ƒè™‘ç”Ÿæˆå’Œæ’å€¼çš„é—®é¢˜ï¼Œéœ€è¦è®©ç¼–ç å™¨çš„è¾“å‡º$z$åˆ†å¸ƒæœä»$N(0,I)$ï¼Œäºæ˜¯æ·»åŠ æ­£åˆ™é¡¹ï¼š $$L_{reg}(\\theta,\\phi) = KL(\\mathbb{E}_{x\\sim data}\\ p_{\\phi}(z|x)||N(0,I)) $$ å› æœ‰ $KL(\\mathbb{E}_p||q)\\leq \\mathbb{E}KL(p||q)$ï¼Œåˆ™VAEçš„æ€»æŸå¤±å‡½æ•°ä¸ºï¼š\n$$\\begin{aligned} L(\\theta,\\phi) \u0026=L_{reconstruct}(\\theta,\\phi)+L_{reg}(\\theta,\\phi)\\\\ \u0026= -\\ \\mathbb{E}_{x\\sim data}\\mathbb{E}_{\\phi}{\\log}\\ p_{\\theta}(x|z) + KL(\\mathbb{E}_{x\\sim data}\\ p_{\\phi}(z|x)||N(0,I)) \\\\ \u0026\\leq \\mathbb{E}_{x\\sim data}[- \\mathbb{E}_{\\phi}{\\log}\\ p_{\\theta}(x|z) + KL(p_{\\phi}(z|x)||N(0,I))] \\end{aligned}$$ å³å¾—åˆ°ELBOï¼(oã‚œâ–½ã‚œ)oâ˜†[BINGO!]  å‚è€ƒé“¾æ¥ï¼š\nhttps://kexue.fm/archives/5253 https://zhuanlan.zhihu.com/p/366204765\nhttps://zhuanlan.zhihu.com/p/78311644\n ","permalink":"https://yupines.github.io/post/vae/","summary":"ç»è¿‡ä¸€æ®µæ—¶é—´ä¸œæ‹¼è¥¿å‡‘çš„å­¦ä¹ ï¼Œå°ç™½ç»ˆäºèƒ½ç†è§£å˜åˆ†è‡ªç¼–ç å™¨äº†å“ˆå“ˆå“ˆï¼Œæ„Ÿè°¢å„è·¯å¤§ç¥çš„æ•™ç¨‹ï¼åœ¨è¿™é‡Œæ•´ç†ä¸€äº›ç®€çŸ­çš„ç¬”è®°ã€‚\nä¸€ã€VAEçš„åˆæ­¥ç†è§£  1. ç»™å®šçœŸå®æ ·æœ¬$X_k$,å‡è®¾å­˜åœ¨ä¸“å±äº$X_k$çš„åéªŒåˆ†å¸ƒ$p(Z|X_k)$,å¹¶å‡å®šè¿™ä¸ªåˆ†å¸ƒæ˜¯æ­£æ€å¤šå…ƒçš„ï¼Œä¸“å±çš„ç›®çš„æ˜¯è®­ç»ƒç”Ÿæˆå™¨$X = g(Z)$,ä»åˆ†å¸ƒ$p(Z|X_k)$é‡‡æ ·å‡ºä¸€ä¸ª$Z_k$å¹¶è¿˜åŸä¸º$\\hat{X_k}$ã€‚\n2. ä½¿ç”¨ç¥ç»ç½‘ç»œæ‹Ÿåˆæ­£æ€åˆ†å¸ƒçš„å‚æ•°ï¼šå‡å€¼$\\mu$å’Œæ–¹å·®${\\sigma}^2$ã€‚äºæ˜¯æ„å»ºä¸¤ä¸ªç¥ç»ç½‘ç»œï¼š${\\mu}k = {f}_1(X_k)$å’Œ${\\log}{\\sigma}_k^2 = {f}_2(X_k)$ ï¼ˆä¸éœ€è¦æ¿€æ´»å‡½æ•°çš„å¤„ç†ï¼‰ã€‚\n3. é‡æ„Xçš„è¿‡ç¨‹éœ€æœ€å°åŒ–$(\\hat{X_k},X_k)$çš„è·ç¦»ï¼Œé‡æ„å™ªå£°ï¼ˆå³æ–¹å·®ï¼‰æ—¢è¦å°½å¯èƒ½åœ°å°ï¼ˆå‡å°‘é‡æ„è¯¯å·®ï¼‰ï¼ŒåŒæ—¶åˆè¦é˜²æ­¢é€€åŒ–ä¸º0ï¼ˆä¿è¯æ¨¡å‹å…·æœ‰ç”Ÿæˆèƒ½åŠ›ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥è®©æ‰€æœ‰æ ·æœ¬çš„$p(Z|X_k)$å‘æ ‡å‡†æ­£æ€åˆ†å¸ƒçœ‹é½ã€‚è‹¥æ¥è¿‘æ­£æ€åˆ†å¸ƒ$N(0,I)$ï¼Œåˆ™ï¼š $$p(Z) = \\sum\\limits_{X}p(Z|X)p(X) = \\sum N(0,I)p(X) = N(0,I)$$ $p(Z)$æ»¡è¶³æ­£æ€åˆ†å¸ƒã€‚æ¥ä¸‹æ¥åˆ©ç”¨KLæ•£åº¦æ¥è®¡ç®—lossï¼Œå³$KL(N(\\mu,{\\sigma}^2)||N(0,I))$ï¼Œè®¡ç®—ç»“æœä¸ºï¼š\n$$\\mathcal{L}_{\\mu,{\\sigma}^2} = \\frac{1}{2}\\sum\\limits_{i=1}^d({\\mu}_{(i)}^2 + {\\sigma}^2_{(i)}-{\\log}{\\sigma}^2_{(i)}-1) $$ å…¶ä¸­$d$æ˜¯å› å˜é‡$Z$çš„ç»´åº¦ã€‚\n 4. é‡å‚æ•°æŠ€å·§ï¼šä»æ­£æ€åˆ†å¸ƒä¸­é‡‡æ · $\\varepsilon$ï¼Œç„¶å$Z = \\mu + \\varepsilon * \\sigma$  äºŒã€VAEçš„ç›®æ ‡å‡½æ•°  ï¼ˆä¸€ï¼‰èƒŒæ™¯çŸ¥è¯†  1.è¾¹ç¼˜åˆ†å¸ƒ  å‡è®¾$p(x,y)$,å…¶ä¸­ä¸€ä¸ªç‰¹å®šå˜é‡çš„è¾¹ç¼˜åˆ†å¸ƒä¸ºï¼š $$p(x) = \\sum\\limits_{y}p(x,y) = \\sum\\limits_{y}p(x|y)p(y)$$  2.äº¤å‰ç†µå’ŒKLæ•£åº¦  äº¤å‰ç†µå’ŒKLå…³ç³»å¯†åˆ‡ï¼Œå¯ä»¥ç”¨æ¥è¡¡é‡ä¸¤ä¸ªåˆ†å¸ƒçš„å·®å¼‚ï¼Œä»¥ç¦»æ•£å˜é‡$x$ä¸ºä¾‹ï¼š $$H(P,Q)=-\\mathbb{E}_{x\\sim P}\\ {\\log}Q(x) = -\\sum\\limits_{i=1}^N P(x_i){\\log}Q(x_i)$$ $KL$æ•£åº¦å®šä¹‰ï¼Œå¯¹$P,Q$åˆ†å¸ƒæœ‰ï¼š $$D_{KL}(P||Q) = \\mathbb{E}_{x\\sim P}[{\\log}\\frac{P(x)}{Q(x)}] = \\mathbb{E}_{x\\sim P}[{\\log}P(x) - {\\log}Q(x)] $$ å¯¹äºç¦»æ•£å‹å˜é‡æœ‰ï¼š $$D_{KL}(P||Q) = \\sum\\limits_{i=1}^N P(x_i)\\ {\\log}(\\frac{P(x_i)}{Q(x_i)}) = \\sum\\limits_{i=1}^N P(x_i)\\ [{\\log}P(x_i)-{\\log}Q(x_i)] $$ å¯¹äºè¿ç»­å‹å˜é‡ï¼Œå…¶æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆprobability density functionï¼ŒPDFï¼‰ç”¨å°å†™å­—æ¯$p(x)$å’Œ$q(x)$æ¥è¡¨ç¤ºï¼Œç¦»æ•£å‹éšæœºå˜é‡çš„æ¦‚ç‡è´¨é‡å‡½æ•°ï¼ˆprobability mass functionï¼ŒPMFï¼‰ç”¨å¤§å†™å­—æ¯è¡¨ç¤ºã€‚","title":"Variational Auto-Encoder"}]